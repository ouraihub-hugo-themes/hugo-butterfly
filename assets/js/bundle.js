"use strict";(()=>{var x=class{static get(e,t){try{let n=localStorage.getItem(e);return n?JSON.parse(n):t??null}catch(n){return console.error(`Error reading from localStorage: ${e}`,n),t??null}}static set(e,t){try{return localStorage.setItem(e,JSON.stringify(t)),!0}catch(n){return console.error(`Error writing to localStorage: ${e}`,n),!1}}static remove(e){try{localStorage.removeItem(e)}catch(t){console.error(`Error removing from localStorage: ${e}`,t)}}static clear(){try{localStorage.clear()}catch(e){console.error("Error clearing localStorage",e)}}};var O=class{constructor(){this.storageKey="theme-mode";this.toggleBtn=null;this.isTransitioning=!1;this.mode=this.getInitialMode(),this.init()}getInitialMode(){let e=x.get(this.storageKey);return e||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")}init(){this.applyMode(!1),this.bindEvents(),this.watchSystemTheme(),this.updateToggleButton()}applyMode(e=!0){let t=document.documentElement;e&&!this.isTransitioning&&(this.isTransitioning=!0,t.classList.add("theme-transitioning"),setTimeout(()=>{t.classList.remove("theme-transitioning"),this.isTransitioning=!1},300)),t.classList.remove("light","dark"),t.classList.add(this.mode),t.setAttribute("data-theme",this.mode),this.updateToggleButton()}updateToggleButton(){if(!this.toggleBtn)return;let e=this.mode==="dark",t=this.toggleBtn.querySelector("svg");if(t){let n=t.querySelector("path");n&&(e?n.setAttribute("d","M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"):n.setAttribute("d","M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"))}this.toggleBtn.setAttribute("aria-pressed",e.toString()),this.toggleBtn.setAttribute("aria-label",e?"Switch to light mode":"Switch to dark mode")}bindEvents(){this.toggleBtn=document.querySelector("[data-darkmode-toggle]"),this.toggleBtn&&(this.toggleBtn.addEventListener("click",()=>this.toggle()),this.toggleBtn.addEventListener("keydown",e=>{(e.key==="Enter"||e.key===" ")&&(e.preventDefault(),this.toggle())}))}watchSystemTheme(){window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",t=>{x.get(this.storageKey)||(this.mode=t.matches?"dark":"light",this.applyMode(!0))})}toggle(){this.mode=this.mode==="dark"?"light":"dark",this.applyMode(!0),x.set(this.storageKey,this.mode),window.dispatchEvent(new CustomEvent("themechange",{detail:{mode:this.mode}}))}getMode(){return this.mode}setMode(e){this.mode=e,this.applyMode(!0),x.set(this.storageKey,e)}};function F(){let s=new O;typeof window<"u"&&(window.darkMode=s)}var q=class{constructor(){this.isOpen=!1;this.scrollPosition=0;this.elements={menuToggle:document.querySelector("[data-menu-toggle]"),menuClose:document.querySelector("[data-menu-close]"),mobileMenu:document.querySelector("[data-mobile-menu]"),menuOverlay:document.querySelector("[data-menu-overlay]"),submenuToggles:document.querySelectorAll("[data-submenu-toggle]")}}init(){if(!this.elements.menuToggle||!this.elements.mobileMenu||!this.elements.menuOverlay){console.warn("Menu elements not found");return}this.bindEvents(),this.initSubmenus()}bindEvents(){this.elements.menuToggle?.addEventListener("click",()=>this.open()),this.elements.menuClose?.addEventListener("click",()=>this.close()),this.elements.menuOverlay?.addEventListener("click",()=>this.close()),document.querySelectorAll(".mobile-menu-item:not(.mobile-menu-parent)").forEach(t=>{t.addEventListener("click",()=>this.close())}),document.addEventListener("keydown",t=>{t.key==="Escape"&&this.isOpen&&this.close()})}initSubmenus(){this.elements.submenuToggles.forEach(e=>{e.addEventListener("click",t=>{t.preventDefault(),this.toggleSubmenu(e)})})}toggleSubmenu(e){let t=e.closest(".mobile-menu-group");if(!t)return;let n=t.querySelector("[data-submenu]"),i=e.querySelector("[data-submenu-icon]");if(!n)return;n.style.maxHeight&&n.style.maxHeight!=="0px"?(n.style.maxHeight="0px",i?.classList.remove("rotate-180"),e.setAttribute("aria-expanded","false")):(n.style.maxHeight=n.scrollHeight+"px",i?.classList.add("rotate-180"),e.setAttribute("aria-expanded","true"))}open(){this.isOpen||(this.scrollPosition=window.pageYOffset,this.disableBodyScroll(),this.elements.mobileMenu?.classList.remove("translate-x-full"),this.elements.menuOverlay?.classList.remove("opacity-0","pointer-events-none"),this.isOpen=!0,this.elements.menuToggle?.setAttribute("aria-expanded","true"),document.dispatchEvent(new CustomEvent("menu:opened")))}close(){this.isOpen&&(this.elements.mobileMenu?.classList.add("translate-x-full"),this.elements.menuOverlay?.classList.add("opacity-0","pointer-events-none"),this.enableBodyScroll(),this.isOpen=!1,this.elements.menuToggle?.setAttribute("aria-expanded","false"),document.dispatchEvent(new CustomEvent("menu:closed")))}disableBodyScroll(){document.body.style.position="fixed",document.body.style.top=`-${this.scrollPosition}px`,document.body.style.width="100%",document.body.style.overflow="hidden"}enableBodyScroll(){document.body.style.position="",document.body.style.top="",document.body.style.width="",document.body.style.overflow="",window.scrollTo(0,this.scrollPosition)}isMenuOpen(){return this.isOpen}};function ae(){let s=document.querySelector("[data-nav]");s&&setTimeout(()=>{s.classList.remove("opacity-0"),s.classList.add("opacity-100")},100)}function le(){let s=document.getElementById("nav"),e=document.querySelector(".menus_items"),t=document.getElementById("toggle-menu");if(!s||!e||!t)return;let n=()=>{window.innerWidth<1024?s.classList.add("hide-menu"):s.classList.remove("hide-menu")};n();let i;window.addEventListener("resize",()=>{clearTimeout(i),i=window.setTimeout(n,150)})}function K(){ae(),le();let s=new q;s.init(),typeof window<"u"&&(window.mobileMenu=s)}function Z(s,e=document){return e.querySelector(s)}function R(s,e,t){s.classList.toggle(e,t)}function j(s,e){let t;return function(...n){let i=this;t||(s.apply(i,n),t=!0,setTimeout(()=>t=!1,e))}}var D=class{constructor(){this.button=null;this.percentElement=null;this.showThreshold=300;this.showPercentThreshold=0;this.init()}init(){this.button=Z("[data-back-to-top]"),this.percentElement=this.button?.querySelector(".scroll-percent")||null,this.button&&(this.bindEvents(),this.updateVisibility())}bindEvents(){this.button?.addEventListener("click",()=>this.scrollToTop()),window.addEventListener("scroll",j(()=>{this.updateVisibility(),this.updateScrollPercent()},100))}updateVisibility(){if(!this.button)return;let e=window.scrollY>this.showThreshold;R(this.button,"show",e)}getScrollPercent(){let e=document.documentElement.scrollHeight,t=window.innerHeight,n=window.scrollY,i=e-t;if(i<=0)return 0;let r=n/i*100;return Math.max(0,Math.min(100,Math.round(r)))}updateScrollPercent(){if(!this.button||!this.percentElement)return;let e=this.getScrollPercent();this.percentElement.textContent=`${e}%`;let t=e>this.showPercentThreshold;R(this.button,"show-percent",t)}scrollToTop(){window.scrollTo({top:0,behavior:"smooth"})}};function U(){let s=new D;typeof window<"u"&&(window.backToTop=s)}var z=class{constructor(){this.elements=null;this.activeHeadingId="";this.observer=null}init(){let e=document.querySelector("[data-toc]");if(!e)return;let t=e.querySelector("[data-toc-content]"),n=e.querySelector("[data-toc-percentage]"),i=e.querySelectorAll(".toc-content a");if(!t||!n||i.length===0)return;let r=this.getHeadings(i);r.length!==0&&(this.elements={tocCard:e,tocContent:t,tocPercentage:n,tocLinks:i,headings:r},this.setupClickHandlers(),this.setupScrollObserver(),this.setupScrollProgress(),this.setupMobileToggle())}getHeadings(e){let t=[];return e.forEach(n=>{let i=n.getAttribute("href");if(i&&i.startsWith("#")){let r=i.substring(1),o=document.getElementById(r);o&&t.push(o)}}),t}setupClickHandlers(){this.elements&&this.elements.tocLinks.forEach(e=>{e.addEventListener("click",t=>{t.preventDefault();let n=e.getAttribute("href");if(n&&n.startsWith("#")){let i=n.substring(1),r=document.getElementById(i);r&&this.scrollToHeading(r)}})})}scrollToHeading(e){let n=e.getBoundingClientRect().top+window.pageYOffset-80;window.scrollTo({top:n,behavior:"smooth"})}setupScrollObserver(){if(!this.elements)return;let e={rootMargin:"-80px 0px -80% 0px",threshold:0};this.observer=new IntersectionObserver(t=>{t.forEach(n=>{n.isIntersecting&&this.setActiveHeading(n.target.id)})},e),this.elements.headings.forEach(t=>{this.observer?.observe(t)})}setActiveHeading(e){if(!this.elements||e===this.activeHeadingId)return;this.activeHeadingId=e,this.elements.tocLinks.forEach(n=>{n.classList.remove("active")});let t=Array.from(this.elements.tocLinks).find(n=>n.getAttribute("href")===`#${e}`);t&&(t.classList.add("active"),this.scrollTocToActiveLink(t))}scrollTocToActiveLink(e){if(this.elements)try{let t=this.elements.tocContent,n=e.getBoundingClientRect(),i=t.getBoundingClientRect();if(n.top<i.top||n.bottom>i.bottom){let r=e.offsetTop-t.offsetTop-t.clientHeight/2;t.scrollTo({top:r,behavior:"smooth"})}}catch{}}setupScrollProgress(){if(!this.elements)return;let e=()=>{let n=window.innerHeight,i=document.documentElement.scrollHeight,r=window.pageYOffset||document.documentElement.scrollTop,o=i-n,a=o>0?r/o*100:0;this.elements?.tocPercentage&&(this.elements.tocPercentage.textContent=`${Math.round(a)}%`)};e();let t=!1;window.addEventListener("scroll",()=>{t||(window.requestAnimationFrame(()=>{e(),t=!1}),t=!0)})}setupMobileToggle(){if(!this.elements)return;let e=window.innerWidth<1024;e&&this.createMobileToggleButton(),window.addEventListener("resize",()=>{window.innerWidth<1024!==e&&location.reload()})}createMobileToggleButton(){if(!this.elements)return;let e=this.elements.tocCard;e.classList.add("mobile-toc"),document.addEventListener("click",t=>{let n=t.target;!e.contains(n)&&e.classList.contains("open")&&e.classList.remove("open")})}toggleMobileToc(){this.elements&&this.elements.tocCard.classList.toggle("open")}destroy(){this.observer&&(this.observer.disconnect(),this.observer=null),this.elements=null,this.activeHeadingId=""}},ce=new z;function V(){ce.init()}function Y(){let s=document.getElementById("aside-cat-list");s&&s.addEventListener("click",e=>{let n=e.target.closest(".card-category-list-link");if(!n||!n.querySelector("i.fa-caret-left"))return;e.preventDefault(),n.classList.toggle("expand");let o=n.parentElement?.querySelector(".card-category-list.child");o&&(n.classList.contains("expand")?(o.style.maxHeight=`${o.scrollHeight}px`,o.style.opacity="1",o.style.visibility="visible"):(o.style.maxHeight="0",o.style.opacity="0",o.style.visibility="hidden"))})}function $(){return document.documentElement.lang||"zh"}function de(s,e){let t=e.getTime()-s.getTime(),n=Math.floor(t/(1e3*60*60*24)),i=Math.floor(t%(1e3*60*60*24)/(1e3*60*60)),r=Math.floor(t%(1e3*60*60)/(1e3*60)),o=Math.floor(t%(1e3*60)/1e3),a=$();return a==="en"?`${n} days ${i} hours ${r} minutes ${o} seconds`:a==="zh-tw"?`${n} \u5929 ${i} \u5C0F\u6642 ${r} \u5206\u9418 ${o} \u79D2`:`${n} \u5929 ${i} \u5C0F\u65F6 ${r} \u5206\u949F ${o} \u79D2`}function ue(s){let t=new Date().getTime()-s.getTime(),n=Math.floor(t/1e3),i=Math.floor(n/60),r=Math.floor(i/60),o=Math.floor(r/24),a=Math.floor(o/30),l=Math.floor(o/365),c=$();return c==="en"?l>0?`${l} year${l>1?"s":""} ago`:a>0?`${a} month${a>1?"s":""} ago`:o>0?`${o} day${o>1?"s":""} ago`:r>0?`${r} hour${r>1?"s":""} ago`:i>0?`${i} minute${i>1?"s":""} ago`:"Just now":c==="zh-tw"?l>0?`${l} \u5E74\u524D`:a>0?`${a} \u500B\u6708\u524D`:o>0?`${o} \u5929\u524D`:r>0?`${r} \u5C0F\u6642\u524D`:i>0?`${i} \u5206\u9418\u524D`:"\u525B\u525B":l>0?`${l} \u5E74\u524D`:a>0?`${a} \u4E2A\u6708\u524D`:o>0?`${o} \u5929\u524D`:r>0?`${r} \u5C0F\u65F6\u524D`:i>0?`${i} \u5206\u949F\u524D`:"\u521A\u521A"}function J(){let s=document.getElementById("runtimeshow");if(!s)return;let e=s.getAttribute("data-publish-date");if(e)try{let t=new Date(e),n=new Date;if(isNaN(t.getTime())){console.error("Invalid publish date:",e);let i=$();s.textContent=i==="en"?"Invalid date format":i==="zh-tw"?"\u65E5\u671F\u683C\u5F0F\u932F\u8AA4":"\u65E5\u671F\u683C\u5F0F\u9519\u8BEF";return}s.textContent=de(t,n)}catch(t){console.error("Error updating runtime:",t);let n=$();s.textContent=n==="en"?"Calculation error":n==="zh-tw"?"\u8A08\u7B97\u932F\u8AA4":"\u8BA1\u7B97\u9519\u8BEF"}}function Q(){let s=document.getElementById("last-push-date");if(!s)return;let e=s.getAttribute("data-last-push-date");if(e)try{let t=new Date(e);if(isNaN(t.getTime())){console.error("Invalid last push date:",e);let n=$();s.textContent=n==="en"?"Invalid date format":n==="zh-tw"?"\u65E5\u671F\u683C\u5F0F\u932F\u8AA4":"\u65E5\u671F\u683C\u5F0F\u9519\u8BEF";return}s.textContent=ue(t)}catch(t){console.error("Error updating last push date:",t);let n=$();s.textContent=n==="en"?"Calculation error":n==="zh-tw"?"\u8A08\u7B97\u932F\u8AA4":"\u8BA1\u7B97\u9519\u8BEF"}}function X(){J(),Q(),document.getElementById("runtimeshow")&&setInterval(J,1e3),document.getElementById("last-push-date")&&setInterval(Q,6e4)}var W=class{constructor(e){this.path=e.path,this.unescape=e.unescape||!1,this.topNPerArticle=e.topNPerArticle||1,this.isfetched=!1,this.datas=null}getIndexByWord(e,t,n=!1){let i=[],r=new Set;return n||(t=t.toLowerCase()),e.forEach(o=>{if(this.unescape){let d=document.createElement("div");d.innerText=o,o=d.innerHTML}let a=o.length;if(a===0)return;let l=0,c=-1;for(n||(o=o.toLowerCase());(c=t.indexOf(o,l))>-1;)i.push({position:c,word:o}),r.add(o),l=c+a}),i.sort((o,a)=>o.position!==a.position?o.position-a.position:a.word.length-o.word.length),[i,r]}mergeIntoSlice(e,t,n){let i=[],r=new Set;if(n.length===0)return{hits:i,start:e,end:t,count:0};let o=n[0];if(!o)return{hits:i,start:e,end:t,count:0};let a=o.position,l=o.word;for(;a+l.length<=t&&n.length!==0;){r.add(l),i.push({position:a,length:l.length});let c=a+l.length;for(n.shift();n.length!==0;){let d=n[0];if(!d)break;if(a=d.position,l=d.word,c>a)n.shift();else break}}return{hits:i,start:e,end:t,count:r.size}}highlightKeyword(e,t){let n="",i=t.start;for(let{position:r,length:o}of t.hits)n+=e.substring(i,r),i=r+o,n+=`<mark class="search-keyword">${e.substr(r,o)}</mark>`;return n+=e.substring(i,t.end),n}getResultItems(e){let t=[];return this.datas&&this.datas.forEach(({title:n,content:i,url:r})=>{let[o,a]=this.getIndexByWord(e,n),[l,c]=this.getIndexByWord(e,i),d=new Set([...a,...c]).size,E=o.length+l.length;if(E===0)return;let p=[];o.length!==0&&p.push(this.mergeIntoSlice(0,n.length,o));let f=[];for(;l.length!==0;){let g=l[0];if(!g)break;let{position:b}=g,M=Math.max(0,b-20),I=Math.min(i.length,b+100);f.push(this.mergeIntoSlice(M,I,l))}f.sort((g,b)=>g.count!==b.count?b.count-g.count:g.hits.length!==b.hits.length?b.hits.length-g.hits.length:g.start-b.start);let P=parseInt(String(this.topNPerArticle),10);P>=0&&(f=f.slice(0,P));let m="",y;try{y=new URL(r).href}catch{y=new URL(r,location.origin).href}let T=new URL(y);T.searchParams.append("highlight",e.join(" ")),p.length!==0&&p[0]?m+=`<li class="local-search-hit-item"><a href="${T.href}"><span class="search-result-title">${this.highlightKeyword(n,p[0])}</span>`:m+=`<li class="local-search-hit-item"><a href="${T.href}"><span class="search-result-title">${n}</span>`,f.forEach(g=>{m+=`<p class="search-result">${this.highlightKeyword(i,g)}...</p>`}),m+="</a></li>",t.push({item:m,id:t.length,hitCount:E,includedCount:d})}),t}async fetchData(){try{let e=await fetch(this.path);if(!e.ok)throw new Error("Failed to load search index");let t=await e.json();this.isfetched=!0,this.datas=t.pages||[],this.datas&&(this.datas=this.datas.filter(n=>n.title).map(n=>(n.title=n.title.trim(),n.content=n.content?n.content.trim().replace(/<[^>]+>/g,""):"",n.url=decodeURIComponent(n.url).replace(/\/{2,}/g,"/"),n))),window.dispatchEvent(new Event("search:loaded"))}catch(e){console.error("Search index load error:",e),window.dispatchEvent(new Event("search:error"))}}highlightSearchWords(e){if(!e)return;let t=new URL(location.href).searchParams.get("highlight"),n=t?t.split(" "):[];if(!n.length)return;let i=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null),r=[];for(;i.nextNode();){let o=i.currentNode.parentNode;o&&!o.matches("button, select, textarea, .mermaid, code, pre")&&r.push(i.currentNode)}r.forEach(o=>{let[a]=this.getIndexByWord(n,o.nodeValue||"");if(!a.length)return;let l=this.mergeIntoSlice(0,(o.nodeValue||"").length,a);this.highlightText(o,l,"search-keyword")})}highlightText(e,t,n){let i=e.nodeValue||"",r=t.start,o=[];for(let{position:a,length:l}of t.hits){let c=document.createTextNode(i.substring(r,a));r=a+l;let d=document.createElement("mark");d.className=n,d.appendChild(document.createTextNode(i.substr(a,l))),o.push(c,d)}e.nodeValue=i.substring(r,t.end),o.forEach(a=>{e.parentNode?.insertBefore(a,e)})}};function G(){let s=window.searchConfig;if(!s||!s.enable)return;let e=new W({path:s.path||"/index.json",unescape:s.unescape||!1,topNPerArticle:s.topNPerArticle||1,pagination:s.pagination,languages:s.languages||{hits_stats:"\u627E\u5230 ${hits} \u6761\u7ED3\u679C",hits_empty:'\u672A\u627E\u5230 "${query}" \u7684\u641C\u7D22\u7ED3\u679C'}}),t=document.querySelector("#local-search"),n=document.getElementById("search-mask"),i=document.querySelector("#local-search .search-dialog"),r=document.querySelector(".local-search-input input"),o=document.getElementById("local-search-stats"),a=document.getElementById("loading-status"),l=document.getElementById("local-search-results"),c=document.getElementById("local-search-pagination");if(!t||!n||!i||!r||!o||!a||!l)return;let d=s.pagination?.enable||!1,E=s.pagination?.hitsPerPage||10,p=0,f=[],P=()=>{document.body.style.overflow="hidden",t.classList.add("show"),n.classList.add("show"),setTimeout(()=>{r.focus()},300),e.isfetched||e.fetchData(),window.innerWidth<768&&i.style.setProperty("--search-height",`${window.innerHeight}px`)},m=()=>{document.body.style.overflow="",i.classList.add("closing"),n.classList.add("closing"),setTimeout(()=>{t.classList.remove("show"),n.classList.remove("show"),i.classList.remove("closing"),n.classList.remove("closing")},500)},y=(u,h)=>{if(!c||!d)return;let v=c.querySelector(".ais-Pagination-list");if(!v)return;if(h<=1){c.style.display="none",v.innerHTML="";return}c.style.display="block";let w=u===0,L=u===h-1,S=window.innerWidth<768?3:5,H=Math.max(0,u-Math.floor(S/2)),B=Math.min(h-1,H+S-1);B-H+1<S&&(H=Math.max(0,B-S+1));let k="";h>S&&H>0&&(k+=`
        <li class="ais-Pagination-item ais-Pagination-item--page">
          <a class="ais-Pagination-link" aria-label="Page 1" href="#" data-page="0">1</a>
        </li>`,H>1&&(k+=`
          <li class="ais-Pagination-item ais-Pagination-item--ellipsis">
            <span class="ais-Pagination-link">...</span>
          </li>`));for(let C=H;C<=B;C++)C===u?k+=`
          <li class="ais-Pagination-item ais-Pagination-item--page ais-Pagination-item--selected">
            <span class="ais-Pagination-link" aria-label="Page ${C+1}">${C+1}</span>
          </li>`:k+=`
          <li class="ais-Pagination-item ais-Pagination-item--page">
            <a class="ais-Pagination-link" aria-label="Page ${C+1}" href="#" data-page="${C}">${C+1}</a>
          </li>`;h>S&&B<h-1&&(B<h-2&&(k+=`
          <li class="ais-Pagination-item ais-Pagination-item--ellipsis">
            <span class="ais-Pagination-link">...</span>
          </li>`),k+=`
        <li class="ais-Pagination-item ais-Pagination-item--page">
          <a class="ais-Pagination-link" aria-label="Page ${h}" href="#" data-page="${h-1}">${h}</a>
        </li>`),v.innerHTML=`
      <li class="ais-Pagination-item ais-Pagination-item--previousPage ${w?"ais-Pagination-item--disabled":""}">
        ${w?'<span class="ais-Pagination-link" aria-label="Previous Page"><i class="fas fa-angle-left"></i></span>':`<a class="ais-Pagination-link" aria-label="Previous Page" href="#" data-page="${u-1}"><i class="fas fa-angle-left"></i></a>`}
      </li>
      ${k}
      <li class="ais-Pagination-item ais-Pagination-item--nextPage ${L?"ais-Pagination-item--disabled":""}">
        ${L?'<span class="ais-Pagination-link" aria-label="Next Page"><i class="fas fa-angle-right"></i></span>':`<a class="ais-Pagination-link" aria-label="Next Page" href="#" data-page="${u+1}"><i class="fas fa-angle-right"></i></a>`}
      </li>`},T=u=>{let h=d?f.slice(p*E,(p+1)*E):u;if(d&&h.length===0&&f.length>0){p=0,T(u);return}let v=h.map((A,S)=>{let H=d?p*E+S+1:S+1;return A.item.replace('<li class="local-search-hit-item">',`<li class="local-search-hit-item" value="${H}">`)});l.innerHTML=`<ol class="search-result-list">${v.join("")}</ol>`;let w=d?f.length:u.length,L=s.languages.hits_stats.replace(/\$\{hits}/,String(w));if(o.innerHTML=`<hr><div class="search-result-stats">${L}</div>`,d&&c){let A=Math.ceil(f.length/E);y(p,A),c.style.display=u.length>0?"":"none"}},g=()=>{l.textContent="",o.textContent="",c&&(c.style.display="none"),d&&(f=[],p=0)},b=u=>{l.textContent="";let h=document.createElement("div");h.className="search-result-stats",h.textContent=s.languages.hits_empty.replace(/\$\{query}/,u),o.innerHTML=h.outerHTML,c&&(c.style.display="none"),d&&(f=[],p=0)},M=()=>{if(!e.isfetched)return;let u=r.value.trim().toLowerCase();u!==""&&(a.hidden=!1);let h=u.split(/[-\s]+/),v=[];u.length>0&&(v=e.getResultItems(h)),h.length===1&&h[0]===""?g():v.length===0?b(u):(v.sort((w,L)=>w.includedCount!==L.includedCount?L.includedCount-w.includedCount:w.hitCount!==L.hitCount?L.hitCount-w.hitCount:L.id-w.id),d&&(f=v,p=0),T(v)),a.hidden=!0},I=document.querySelector("#search-button .search");I&&I.addEventListener("click",P);let N=document.querySelector("#local-search .search-close-button");N&&N.addEventListener("click",m),n.addEventListener("click",m),document.addEventListener("keydown",u=>{u.key==="Escape"&&t.classList.contains("show")&&m()}),r.addEventListener("input",M),c&&d&&c.addEventListener("click",u=>{u.preventDefault();let v=u.target.closest("a[data-page]");if(v){let w=parseInt(v.dataset.page||"0",10);!isNaN(w)&&f.length>0&&(p=w,T(f))}}),window.addEventListener("search:loaded",()=>{let u=document.getElementById("loading-database");if(u){let h=u.nextElementSibling;h&&(h.style.visibility="visible"),u.remove()}}),e.highlightSearchWords(document.getElementById("article-container")),s.preload&&e.fetchData()}function ee(){let s=document.querySelector("#search-button .search"),e=document.querySelector("#local-search"),t=document.getElementById("search-mask"),n=document.querySelector(".search-close-button"),i=document.getElementById("pagefind-search-input"),r=document.getElementById("local-search-results"),o=document.getElementById("local-search-stats"),a=document.getElementById("loading-status");if(!s||!e||!t||!i||!r||!o){console.error("Search elements not found in the DOM");return}let l=!1,c=()=>{document.body.style.overflow="hidden",e.classList.add("show"),t.classList.add("show"),setTimeout(()=>{i.focus()},300)},d=()=>{document.body.style.overflow="",e.classList.remove("show"),t.classList.remove("show")},E=(m,y)=>{if(!m)return"";if(!y)return m;let T=new RegExp(`(${y})`,"gi");return m.replace(T,'<mark class="search-keyword">$1</mark>')},p=async m=>{if(!m||m.length===0){r.innerHTML="",o.innerHTML=`
        <div class="search-result-stats">
          ${i.value.trim()?`\u672A\u627E\u5230 "${i.value}" \u7684\u641C\u7D22\u7ED3\u679C`:"\u8BF7\u8F93\u5165\u641C\u7D22\u8BCD"}
        </div>
      `;return}let y=[],T=i.value.trim();for(let g=0;g<m.length;g++){let b=m[g];if(b)try{let M=await b.data(),I=E(M.meta.title,T),N=E(M.excerpt,T);y.push(`
          <li class="local-search-hit-item" value="${g+1}">
            <a href="${M.url}">
              <span class="search-result-title">${I}</span>
              <p class="search-result">${N}...</p>
            </a>
          </li>
        `)}catch(M){console.error("Error processing search result:",M);continue}}r.innerHTML=`
      <ol class="search-result-list">
        ${y.join("")}
      </ol>
    `,o.innerHTML=`
      <hr>
      <div class="search-result-stats">
        \u627E\u5230 ${m.length} \u6761\u7ED3\u679C
      </div>
    `},f=async m=>{if(!m.trim()){r.innerHTML="",o.innerHTML="";return}if(!window.pagefind){console.error("Pagefind not loaded");return}try{a&&(a.hidden=!1);let y=await window.pagefind.debouncedSearch(m,{debounce:300});if(a&&(a.hidden=!0),!y){console.warn("Search returned null or undefined"),await p(null);return}await p(y.results)}catch(y){console.error("Search error:",y),a&&(a.hidden=!0),r.innerHTML="",o.innerHTML=`
        <div class="search-result-stats">
          \u641C\u7D22\u51FA\u9519\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5
        </div>
      `}};s.addEventListener("click",c),n?.addEventListener("click",d),t.addEventListener("click",d),document.addEventListener("keydown",m=>{m.key==="Escape"&&e.classList.contains("show")&&d()}),i.addEventListener("input",()=>{f(i.value)});let P=setInterval(()=>{window.pagefind&&!l&&(l=!0,clearInterval(P),console.log("\u2728 Pagefind loaded successfully"))},100);setTimeout(()=>{clearInterval(P)},1e4)}var he={showCopyButton:!0,showExpandButton:!0,heightLimit:400,macStyle:!0,copySuccessText:"\u5DF2\u590D\u5236",copyText:"\u590D\u5236",expandText:"\u5C55\u5F00",collapseText:"\u6536\u8D77"};async function me(s){try{if(navigator.clipboard&&window.isSecureContext)return await navigator.clipboard.writeText(s),!0;let e=document.createElement("textarea");e.value=s,e.style.position="fixed",e.style.left="-999999px",e.style.top="-999999px",document.body.appendChild(e),e.focus(),e.select();let t=document.execCommand("copy");return document.body.removeChild(e),t}catch(e){return console.error("Failed to copy text:",e),!1}}function ge(s,e){let t=s.innerHTML,n=s.querySelector("i"),i=s.querySelector("span");s.classList.add("copied"),n&&(n.className="fas fa-check"),i&&(i.textContent=e.copySuccessText||"\u5DF2\u590D\u5236"),setTimeout(()=>{s.classList.remove("copied"),s.innerHTML=t},2e3)}function pe(s,e){let t=s.closest(".highlight-wrapper");if(!t)return;let n=t.querySelector(".highlight code");if(!n)return;let i=n.textContent||"";me(i).then(r=>{r?ge(s,e):console.error("Failed to copy code")})}function fe(s){let e=s.closest(".highlight-wrapper");if(!e)return;e.classList.toggle("collapsed"),s.querySelector("i")&&s.classList.toggle("collapsed")}function ye(s){let e=s.closest(".highlight-wrapper");if(!e)return;e.classList.toggle("expanded");let t=e.classList.contains("expanded"),n=s.querySelector("i");n&&(n.style.transform=t?"rotate(180deg)":"")}function ve(s,e){let t=document.createElement("div");if(t.className="highlight-tools",e.macStyle){let i=document.createElement("div");i.className="mac-buttons",i.innerHTML=`
      <span class="mac-close"></span>
      <span class="mac-minimize"></span>
      <span class="mac-maximize"></span>
    `,t.appendChild(i)}let n=document.createElement("div");if(n.className="code-lang",n.textContent=s||"CODE",t.appendChild(n),e.showExpandButton){let i=document.createElement("button");i.className="expand-button",i.innerHTML='<i class="fas fa-chevron-down"></i>',i.setAttribute("aria-label","\u5C55\u5F00/\u6298\u53E0\u4EE3\u7801"),i.addEventListener("click",()=>fe(i)),t.appendChild(i)}if(e.showCopyButton){let i=document.createElement("button");i.className="copy-button",i.innerHTML=`
      <i class="fas fa-copy"></i>
      <span>${e.copyText||"\u590D\u5236"}</span>
    `,i.setAttribute("aria-label","\u590D\u5236\u4EE3\u7801"),i.addEventListener("click",()=>pe(i,e)),t.appendChild(i)}return t}function be(s){let e=document.createElement("button");return e.className="code-expand-btn",e.innerHTML='<i class="fas fa-angle-down"></i>',e.setAttribute("aria-label",s.expandText||"\u5C55\u5F00\u4EE3\u7801"),e.addEventListener("click",()=>ye(e)),e}function te(s,e){if(s.parentElement?.classList.contains("highlight-wrapper"))return;let t=Array.from(s.classList).find(o=>o.startsWith("language-")),n=t?t.replace("language-",""):"",i=document.createElement("div");i.className="highlight-wrapper",e.macStyle&&i.classList.add("mac-style"),s.parentNode?.insertBefore(i,s),i.appendChild(s);let r=ve(n,e);if(i.insertBefore(r,s),e.heightLimit&&e.heightLimit>0){let o=s.querySelector("pre");if(o&&o.scrollHeight>e.heightLimit){i.classList.add("has-height-limit");let a=be(e);i.appendChild(a)}}}function ne(s){let e={...he,...s};document.querySelectorAll(".highlight").forEach(n=>{te(n,e)}),typeof MutationObserver<"u"&&new MutationObserver(i=>{i.forEach(r=>{r.addedNodes.forEach(o=>{o instanceof Element&&o.querySelectorAll(".highlight").forEach(l=>{te(l,e)})})})}).observe(document.body,{childList:!0,subtree:!0})}function ie(){let s={},e=document.documentElement,t=e.dataset.highlightCopy,n=e.dataset.highlightExpand,i=e.dataset.highlightHeightLimit,r=e.dataset.highlightMacStyle;return t!==void 0&&(s.showCopyButton=t==="true"),n!==void 0&&(s.showExpandButton=n==="true"),i!==void 0&&(s.heightLimit=parseInt(i,10)),r!==void 0&&(s.macStyle=r==="true"),s}function we(s,e,t){let n=document.createElement(e);Object.entries(t).forEach(([i,r])=>{n.setAttribute(i,r)}),s.parentNode?.insertBefore(n,s),n.appendChild(s)}function Te(s){if(typeof window.mediumZoom!="function"){console.warn("medium-zoom library not loaded");return}let e=window.mediumZoom;e(s,{margin:24,background:"var(--zoom-bg, rgba(0, 0, 0, 0.9))",scrollOffset:0}),console.log(`\u2705 Medium Zoom initialized for ${s.length} images`)}function Ee(s){if(typeof window.Fancybox>"u"){console.warn("Fancybox library not loaded");return}let e=window.Fancybox;if(s.forEach(n=>{if(n.parentElement?.tagName==="A")return;let i=n.dataset.lazySrc||n.src,r=n.title||n.alt||"";we(n,"a",{href:i,"data-fancybox":"gallery","data-caption":r,"data-thumb":i})}),window.fancyboxRun)return;let t={Hash:!1,Carousel:{transition:"slide"},Toolbar:{display:{left:["infobar"],middle:["zoomIn","zoomOut","toggle1to1","rotateCCW","rotateCW","flipX","flipY"],right:["slideshow","thumbs","close"]}},Images:{Panzoom:{maxScale:4}},Thumbs:{showOnStart:!1}};e.bind("[data-fancybox]",t),window.fancyboxRun=!0,console.log(`\u2705 Fancybox initialized for ${s.length} images`)}function Le(){let s=document.querySelector('meta[name="lightbox-config"]');if(s)try{let e=s.getAttribute("content");if(e)return JSON.parse(e)}catch(e){console.error("Failed to parse lightbox config:",e)}return{type:"medium_zoom",selector:"#article-container img",excludeClass:"no-lightbox"}}function se(s){let t={...Le(),...s};if(!t.type){console.log("Lightbox is disabled");return}let n=`${t.selector}:not(.${t.excludeClass})`,i=document.querySelectorAll(n);if(i.length===0){console.log("No images found for lightbox");return}switch(t.type){case"medium_zoom":Te(i);break;case"fancybox":Ee(i);break;default:console.warn(`Unknown lightbox type: ${t.type}`)}}var _=class{constructor(){this.storageKey="butterfly-theme-color";this.currentTheme="sapphire";this.themeSelectBtn=null;this.themePanel=null;this.isTransitioning=!1;this.themes={sapphire:{id:"sapphire",name:"\u5B9D\u77F3\u84DD",description:"\u4E13\u4E1A\u3001\u53EF\u4FE1\u3001\u79D1\u6280\u611F",category:"cool",className:"theme-sapphire"},purple:{id:"purple",name:"\u7687\u5BB6\u7D2B",description:"\u4F18\u96C5\u3001\u521B\u610F\u3001\u9AD8\u7AEF",category:"cool",className:"theme-purple"},cyan:{id:"cyan",name:"\u6E05\u723D\u9752",description:"\u73B0\u4EE3\u3001\u79D1\u6280\u3001\u6E05\u65B0",category:"cool",className:"theme-cyan"},"cool-gray":{id:"cool-gray",name:"\u51B7\u7070\u84DD",description:"\u6781\u7B80\u3001\u4E13\u4E1A\u3001\u6C89\u9759",category:"cool",className:"theme-cool-gray"},crimson:{id:"crimson",name:"\u70C8\u706B\u7EA2",description:"\u70ED\u60C5\u3001\u6D3B\u529B\u3001\u5438\u5F15\u529B",category:"warm",className:"theme-crimson"},orange:{id:"orange",name:"\u6E29\u6696\u6A59",description:"\u53CB\u597D\u3001\u6E29\u6696\u3001\u4EB2\u8FD1",category:"warm",className:"theme-orange"},pink:{id:"pink",name:"\u6A31\u82B1\u7C89",description:"\u6E29\u67D4\u3001\u4F18\u7F8E\u3001\u5973\u6027\u5316",category:"warm",className:"theme-pink"},brown:{id:"brown",name:"\u79CB\u571F\u8910",description:"\u7A33\u91CD\u3001\u81EA\u7136\u3001\u6000\u65E7",category:"warm",className:"theme-brown"}};this.currentTheme=this.getInitialTheme(),this.init()}getInitialTheme(){let e=x.get(this.storageKey);return e&&this.themes[e]?e:"sapphire"}init(){this.applyTheme(this.currentTheme,!1),this.bindEvents()}applyTheme(e,t=!0){let n=document.documentElement,i=this.themes[e];if(!i){console.warn(`Theme "${e}" not found`);return}t&&!this.isTransitioning&&(this.isTransitioning=!0,n.classList.add("theme-transitioning"),setTimeout(()=>{n.classList.remove("theme-transitioning"),this.isTransitioning=!1},300)),Object.values(this.themes).forEach(r=>{n.classList.remove(r.className)}),n.classList.add(i.className),n.setAttribute("data-theme-color",e),this.currentTheme=e,this.updatePanelState(),window.dispatchEvent(new CustomEvent("themechange",{detail:{color:e,theme:i}}))}updatePanelState(){if(!this.themePanel)return;this.themePanel.querySelectorAll("[data-theme-item]").forEach(t=>{t.getAttribute("data-theme-item")===this.currentTheme?(t.classList.add("active"),t.setAttribute("aria-pressed","true")):(t.classList.remove("active"),t.setAttribute("aria-pressed","false"))})}bindEvents(){this.themeSelectBtn=document.querySelector("[data-theme-switcher-btn]"),this.themePanel=document.querySelector("[data-theme-panel]"),this.themeSelectBtn&&(this.themeSelectBtn.addEventListener("click",e=>{e.stopPropagation(),this.togglePanel()}),this.themeSelectBtn.addEventListener("keydown",e=>{(e.key==="Enter"||e.key===" ")&&(e.preventDefault(),this.togglePanel())})),this.themePanel&&(this.themePanel.querySelectorAll("[data-theme-item]").forEach(t=>{t.addEventListener("click",n=>{let i=t.getAttribute("data-theme-item");this.setTheme(i),this.closePanel()}),t.addEventListener("keydown",n=>{if(n.key==="Enter"||n.key===" "){n.preventDefault();let i=t.getAttribute("data-theme-item");this.setTheme(i),this.closePanel()}})}),document.addEventListener("click",t=>{!this.themePanel?.contains(t.target)&&!this.themeSelectBtn?.contains(t.target)&&this.closePanel()}))}togglePanel(){if(!this.themePanel)return;this.themePanel.classList.contains("active")?this.closePanel():this.openPanel()}openPanel(){this.themePanel&&(this.themePanel.classList.add("active"),this.updatePanelState())}closePanel(){this.themePanel&&this.themePanel.classList.remove("active")}getCurrentTheme(){return this.currentTheme}setTheme(e){if(!this.themes[e]){console.warn(`Theme "${e}" not found`);return}this.applyTheme(e,!0),x.set(this.storageKey,e)}getAllThemes(){return this.themes}getThemesByCategory(e){return Object.values(this.themes).filter(t=>t.category===e)}};function oe(){let s=new _;typeof window<"u"&&(window.themeSwitcher=s)}function re(){console.log("\u{1F98B} Initializing Butterfly Theme..."),F(),oe(),K(),U(),V(),Y(),X(),document.querySelector("#local-search")?ee():G();let e=ie();ne(e),se(),console.log("\u2705 Butterfly Theme initialized successfully")}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",re):re();})();
